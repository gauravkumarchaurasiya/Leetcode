<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>100 Days of LeetCode</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@glidejs/glide@3.5.2/dist/css/glide.core.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="bg-gray-50 min-h-screen font-['Inter']">
    <!-- Navigation Bar -->
    <nav class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl font-bold text-indigo-600">ðŸŽ¯</span>
                    <div class="ml-6 flex space-x-8">
                        <a href="/static/index.html" class="border-indigo-500 text-gray-900 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Daily Posts</a>
                        <a href="/static/blog.html" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Solutions Blog</a>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- Social Links -->
                    <div class="hidden md:flex items-center space-x-3 mr-4">
                        <a href="https://gauravkumarchaurasiya.github.io/" target="_blank" class="text-gray-500 hover:text-indigo-600" title="Portfolio">
                            <i class="fas fa-globe text-xl"></i>
                        </a>
                        <a href="https://leetcode.com/u/gauravkumarchaurasiya/" target="_blank" class="text-gray-500 hover:text-indigo-600" title="LeetCode">
                            <i class="fas fa-code text-xl"></i>
                        </a>
                        <a href="https://github.com/gauravkumarchaurasiya/" target="_blank" class="text-gray-500 hover:text-indigo-600" title="GitHub">
                            <i class="fab fa-github text-xl"></i>
                        </a>
                    </div>
                    <a href="/add-post" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700">Add Post</a>
                    <a href="/add-blog" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-indigo-600 bg-indigo-50 hover:bg-indigo-100">Add Blog</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Stats Modal -->
    <div id="statsModal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50">
        <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
            <div class="mt-3">
                <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Detailed Statistics</h3>
                <div id="detailedStats" class="space-y-4">
                    <!-- Stats will be inserted here -->
                </div>
                <div class="mt-4 text-right">
                    <button id="closeModal" class="px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-md hover:bg-indigo-700">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Profile Section -->
        <div class="mb-8 bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-6">
                    <div class="flex-shrink-0">
                        <img class="h-24 w-24 rounded-full" src="https://avatars.githubusercontent.com/u/99001707?v=4" alt="Profile">
                    </div>
                    <div>
                        <h1 class="text-3xl font-bold text-gray-900">GAURAV KUMAR CHAURASIYA's #100DaysOfLeetCode</h1>
                        <p class="text-gray-600 mt-2">Documenting my journey through LeetCode challenges</p>
                        <div class="flex items-center space-x-4 mt-4">
                            <div class="flex items-center">
                                <i class="fas fa-check-circle text-green-500 mr-2"></i>
                                <span class="text-sm text-gray-600">Problems Solved: <span id="totalProblems" class="font-semibold">0</span></span>
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-calendar text-blue-500 mr-2"></i>
                                <span class="text-sm text-gray-600">Current Day: <span id="currentDay" class="font-semibold">0</span>/100</span>
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-fire text-orange-500 mr-2"></i>
                                <span class="text-sm text-gray-600">Current Streak: <span id="currentStreak" class="font-semibold">0</span> days</span>
                            </div>
                        </div>
                    </div>
                </div>
                <button id="showStats" class="px-4 py-2 text-indigo-600 hover:text-indigo-900 text-sm font-medium">
                    <i class="fas fa-chart-bar mr-1"></i> View Stats
                </button>
            </div>
            <!-- Progress bar will be inserted here -->
        </div>

        <div id="postContainer" class="space-y-8"></div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/@glidejs/glide"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/date-fns/2.29.3/date-fns.min.js"></script>
    <script>
        // Modal functionality
        const modal = document.getElementById('statsModal');
        const showStatsBtn = document.getElementById('showStats');
        const closeModalBtn = document.getElementById('closeModal');

        showStatsBtn.onclick = () => modal.classList.remove('hidden');
        closeModalBtn.onclick = () => modal.classList.add('hidden');
        window.onclick = (e) => {
            if (e.target === modal) modal.classList.add('hidden');
        };

        fetch('/static/data/posts.json')
            .then(res => res.json())
            .catch(() => [])
            .then(posts => {
                const calculateStats = (posts) => {
                    // Basic stats
                    const totalProblems = posts.reduce((sum, post) => 
                        sum + post.leetcode_ids.length, 0);
                    const currentDay = posts.length;
                    
                    // Calculate streak
                    let currentStreak = 0;
                    if (posts.length > 0) {
                        const today = new Date();
                        today.setHours(0, 0, 0, 0);
                        
                        const lastPost = new Date(posts[0].date);
                        lastPost.setHours(0, 0, 0, 0);
                        
                        const diffDays = Math.floor((today - lastPost) / (1000 * 60 * 60 * 24));
                        
                        if (diffDays <= 1) {
                            currentStreak = 1;
                            for (let i = 1; i < posts.length; i++) {
                                const currentDate = new Date(posts[i-1].date);
                                const prevDate = new Date(posts[i].date);
                                const diff = Math.floor((currentDate - prevDate) / (1000 * 60 * 60 * 24));
                                
                                if (diff === 1) currentStreak++;
                                else break;
                            }
                        }
                    }

                    // Calculate average problems per day
                    const avgProblems = currentDay > 0 ? (totalProblems / currentDay).toFixed(1) : 0;

                    // Best day (most problems)
                    const bestDay = posts.reduce((best, post) => {
                        return post.leetcode_ids.length > best.count ? 
                            {date: post.date, count: post.leetcode_ids.length} : best;
                    }, {date: '', count: 0});

                    // Tag statistics
                    const tagCounts = posts.reduce((counts, post) => {
                        post.tags.forEach(tag => {
                            counts[tag] = (counts[tag] || 0) + 1;
                        });
                        return counts;
                    }, {});

                    const topTags = Object.entries(tagCounts)
                        .sort(([,a], [,b]) => b - a)
                        .slice(0, 5);

                    return {
                        totalProblems,
                        currentDay,
                        currentStreak,
                        avgProblems,
                        bestDay,
                        topTags
                    };
                };

                const stats = calculateStats(posts);

                // Update basic stats
                document.getElementById('totalProblems').textContent = stats.totalProblems;
                document.getElementById('currentDay').textContent = stats.currentDay;
                document.getElementById('currentStreak').textContent = stats.currentStreak;

                // Update detailed stats modal
                const detailedStatsHtml = `
                    <div class="space-y-3">
                        <div class="flex justify-between items-center py-2 border-b">
                            <span class="text-gray-600">Average Problems/Day</span>
                            <span class="font-semibold">${stats.avgProblems}</span>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b">
                            <span class="text-gray-600">Best Day</span>
                            <span class="font-semibold">${stats.bestDay.date} (${stats.bestDay.count} problems)</span>
                        </div>
                        <div class="py-2 border-b">
                            <span class="text-gray-600">Top Tags</span>
                            <div class="mt-2 flex flex-wrap gap-2">
                                ${stats.topTags.map(([tag, count]) => 
                                    `<span class="px-2 py-1 bg-indigo-100 text-indigo-800 text-xs rounded-full">
                                        ${tag} (${count})
                                    </span>`
                                ).join('')}
                            </div>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b">
                            <span class="text-gray-600">Completion</span>
                            <span class="font-semibold">${stats.currentDay}%</span>
                        </div>
                        <div class="flex justify-between items-center py-2">
                            <span class="text-gray-600">Days Remaining</span>
                            <span class="font-semibold">${100 - stats.currentDay}</span>
                        </div>
                    </div>
                `;
                document.getElementById('detailedStats').innerHTML = detailedStatsHtml;

                // Add progress bar
                const progressPercentage = (stats.currentDay / 100) * 100;
                const progressBar = `
                    <div class="mt-4">
                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                            <div class="bg-indigo-600 h-2.5 rounded-full" style="width: ${progressPercentage}%"></div>
                        </div>
                        <div class="mt-2 text-sm text-gray-500 text-right">${progressPercentage}% Complete</div>
                    </div>
                `;
                document.querySelector('.mb-8').insertAdjacentHTML('beforeend', progressBar);

                const container = document.getElementById('postContainer');
                posts.forEach((post, index) => {
                    const tags = post.tags.map(tag => 
                        `<span class="inline-flex items-center px-3 py-0.5 rounded-full text-sm font-medium bg-indigo-100 text-indigo-800 mr-2">#${tag}</span>`
                    ).join('');
                    
                    const leetcodeLinks = post.leetcode_ids.map((id, idx) => 
                        `<div class="flex items-start space-x-3 p-2 hover:bg-gray-50 rounded-lg transition-colors">
                            <span class="text-gray-400 text-sm mt-0.5">${idx + 1}.</span>
                            <div class="flex flex-col">
                                <a href="https://leetcode.com/problems/${id}/" target="_blank" 
                                class="text-indigo-600 hover:text-indigo-900 font-medium flex items-center">
                                    ${id}
                                    <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                                    </svg>
                                </a>
                            </div>
                        </div>`
                    ).join('');
                    
                    const images = post.images.map(img => 
                        `<li class="glide__slide">
                            <img src="/static/images/${img}" class="rounded-lg w-full object-cover h-64">
                         </li>`
                    ).join('');

                    const html = `
                        <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                            <div class="p-6">
                                <div class="flex items-center justify-between mb-4">
                                    <h2 class="text-xl font-semibold text-gray-900">Day: ${post.date}</h2>
                                    <div class="flex items-center space-x-2">
                                        <span class="text-sm text-gray-500">Problems solved:</span>
                                        <span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded-full">${post.leetcode_ids.length}</span>
                                    </div>
                                </div>
                                
                                <p class="text-gray-700 mb-4 whitespace-pre-line">${post.description}</p>
                                
                                <div class="mb-4">
                                    <span class="text-sm font-medium text-gray-500">LeetCode Problems:</span>
                                    <div class="mt-2 flex flex-col divide-y divide-gray-100 border rounded-lg bg-white">
                                        ${leetcodeLinks}
                                    </div>
                                </div>

                                ${images ? `
                                    <div class="mb-6">
                                        <div class="glide" id="slider-${index}">
                                            <div class="glide__track" data-glide-el="track">
                                                <ul class="glide__slides">${images}</ul>
                                            </div>
                                        </div>
                                    </div>
                                ` : ''}

                                <div class="flex flex-wrap gap-2">${tags}</div>
                            </div>
                        </div>
                    `;
                    container.insertAdjacentHTML('beforeend', html);

                    if (images) {
                        new Glide(`#slider-${index}`, {
                            type: 'carousel',
                            perView: 1,
                            gap: 0,
                            autoplay: 3000
                        }).mount();
                    }
                });
            });

    </script>
</body>
</html>